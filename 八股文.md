####  mysql引擎

mysql常见存储引擎，InnoDb,MyISAM,MEMORY。区别在事务支持，外键支持，存储限制，空间使用，插入速度的区别。

| 特性     | InnoDb | MyISAM         | MEMORY         |
| -------- | ------ | -------------- | -------------- |
| 事务支持 | 支持   | 不支持         | 不支持         |
| 外键     | 支持   | 不支持         | 不支持         |
| 存储限制 | 64TB   | 有，视情况而定 | 有，视情况而定 |
| 空间使用 | 高     | 低             | 低             |
| 内存使用 | 高     | 低             | 高             |
| 插入速度 | 低     | 高             | 高             |

mysql 5.5.5之前是默认引擎是MyISAM。

MyISAM特点：插入速度快，空间和内存使用较低。主要用于插入新纪录和读取数据。

MEMORY特点：所有数据都在内存中，数据的处理速度特别快，但是安全性不高，不能建立太大的表。

### mysql事务

一般来说，事务必须满足四个条件：原子性，一致性，隔离性，持久性

#### 原子性

一个事务中的所有操作，要么全部完成，要么全部不完成。不会结束在中间某个环节，事务在执行过程中发生错误，会被回滚至事务最开始的状态，就好像这个事务没有发生过一样。

#### 一致性

在事务的开始之前和结束之后，数据库的完整性没有被破坏。

#### 隔离性

数据库允许多个事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据库不一致。事务有不同的隔离级别：**读未提交**，**读已提交**，**可重复读**和**串行化**。mysql innodb默认隔离级别为**可重复读**。

##### 事务并发问题

- 脏读：事务A读取了事务B更新的数据，然后B回滚操作，那么A读取到的数据就是脏数据。

- 不可重复读：事务A多次读取同一事务，事务B在事务A多次读取的过程中，对数据做了更新并提交，导致事务A多次读取同一数据时，结果不一致。

- 幻读：系统管理员A将数据库中的学生成绩从具体分数改为ABCDE等级，但是这时系统管理员B就在这个时候插入了一条具体分数的记录，当系统管理员A改结束后发现还有一条记录没有改过来，就好像发生了幻觉一样。

  **注**：不可重复读和幻读很容易混淆，不可重复读侧重于修改，幻读侧重于新增或删除。

#### 持久性

事务处理结束后，对数据的修改是永久的。

| 隔离级别 | **脏读** | **不可重复读** | **幻读** |
| -------- | -------- | -------------- | -------- |
| 读未提交 | 可能     | 可能           | 可能     |
| 读已提交 | 不可能   | 可能           | 可能     |
| 可重复读 | 不可能   | 不可能         | 可能     |
| 可串行化 | 不可能   | 不可能         | 不可能   |

#### mysql sql语句优化

